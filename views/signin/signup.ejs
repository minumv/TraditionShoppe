<%- include('../layout/authheader') %>

<body>
<div class="container">
	<div class="d-flex justify-content-center h-100">
		<div class="card" style="height: 570px;top:10%;">
			<div class="card-header">
				<h3 style="color:#4F0341">Sign Up</h3>				
				<div class="d-flex justify-content-end social_icon">
					<!-- <span><i class="fab fa-facebook-square"></i></span> -->
					<a href="/authSign/google"><span><i class="fab fa-google-plus-square"></i></span></a>
					<!-- <span><i class="fab fa-twitter-square"></i></span> -->
				</div>
			</div>
			<div class="card-body">
				
					<div class="input-group form-group">
						<div class="input-group-prepend">
							<span class="input-group-text"><i class="fas fa-user"></i></span>
						</div>
						<input type="text" name="name" class="form-control" placeholder="name" required pattern="^[a-zA-Z]+[\-'\s]?[a-zA-Z ]+$">
						
					</div>
					<div class="input-group form-group">
						<div class="input-group-prepend">
							<span class="input-group-text"><i class="fas fa-envelope"></i></span>
						</div>
						<input type="email" name="email" class="form-control" placeholder="email"  required > 
					</div>
                    <div class="input-group form-group">
						<div class="input-group-prepend">
							<span class="input-group-text"><i class="fas fa-mobile"></i></span>
						</div>
						<input type="text" name="phone" class="form-control" placeholder="mobile" required >
					</div>
                    <div class="input-group form-group">
						<div class="input-group-prepend">
							<span class="input-group-text"><i class="fas fa-key"></i></span>
						</div>
						<input type="password" name="password" class="form-control" placeholder="password" required>
					</div>
                    <div class="input-group form-group">
						<div class="input-group-prepend">
							<span class="input-group-text"><i class="fas fa-key"></i></span>
						</div>
						<input type="password" name ="confirmpassword" class="form-control" placeholder="confirm password" required>
					</div>
					<div class="input-group form-group">
						<div class="input-group-prepend">
							<span class="input-group-text"><i class="fas fa-code"></i></span>
						</div>
						<%if(referalCode){%>
							<input type="text" name="refferal" class="form-control" placeholder="Referral Code " value=<%=referalCode%> required >
						<%} else {%>
							<input type="text" name="refferal" class="form-control" placeholder="Referral Code " required >
						<%}%>
						<span style="font-size:13px;">*Add refferal code here if any, otherwise type 'No'</span>
					</div>
					<!-- <div class="row align-items-center remember">
						<input type="checkbox">Remember Me
					</div> -->
					<div class="form-group">
						<button type="button" onclick="customerSignup()"  class="btn float-right login_btn">Signup</button>
					</div>
				
			</div>

			

			<div class="card-footer">
				<div class="d-flex justify-content-center links">
					Already have an account?<a href="/signin/userLogin" style="color:#6814dd">Log In</a>
				</div>
				<!-- <div class="d-flex justify-content-center">
					<a href="#">Forgot your password?</a>
				</div> -->
			</div>
		</div>
		<% if (errorMessage.length > 0) { %>                
			<div class="alert alert-danger" role="alert"> <%- errorMessage %>  </div>                  
		  <% } %>
		  <% if (successMessage.length > 0) { %>                
			<div class="alert alert-success" role="alert"> <%- successMessage %>  </div>                    
		  <% } %>
	</div>
</div>
<script>
	function customerSignup (){
		const name = document.querySelector('input[name="name"]').value
		const email = document.querySelector('input[name="email"]').value
		const phone = document.querySelector('input[name="phone"]').value
		const password = document.querySelector('input[name="password"]').value
		const confirmpassword = document.querySelector('input[name="confirmpassword"]').value
		const refferal = document.querySelector('input[name="refferal"]').value

		const formData = {
			name,email,phone,password,confirmpassword,refferal
		}

		console.log("formData :",formData )
		fetch('/addCustomer',{
			method:"post",
			headers:{
			'Content-Type':'application/json'
			},
			body:JSON.stringify(formData)
		})
		.then((res)=>res.json())
		.then((data)=>{
			console.log("data :",data.data._id)
			if(data.success){
				location.href=`/loadOTP/${data.data._id}/${data.data.email}`
			} else {
				location.href='/signin/signup'
			}
		})
	}
</script>
<%- include('../layout/authfooter') %>